

CSI API ETABS v1

# cPropAreaSetShellLayer Method  
  
---  
  
Assigns the layer parameters for shell-type area properties

**Namespace:** [ETABSv1](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)  
**Assembly:** ETABSv1 (in ETABSv1.dll) Version: 1.0.0.0 (1.27.0.0)

![](../icons/SectionExpanded.png)Syntax

C#

VB

C++

F#

Copy

    
    
    int SetShellLayer(
    	string Name,
    	int NumberLayers,
    	ref string[] LayerName,
    	ref double[] Dist,
    	ref double[] Thickness,
    	ref string[] MatProp,
    	ref bool[] Nonlinear,
    	ref double[] MatAng,
    	ref int[] NumIntegrationPts
    )
    
    
    Function SetShellLayer ( 
    	Name As String,
    	NumberLayers As Integer,
    	ByRef LayerName As String(),
    	ByRef Dist As Double(),
    	ByRef Thickness As Double(),
    	ByRef MatProp As String(),
    	ByRef Nonlinear As Boolean(),
    	ByRef MatAng As Double(),
    	ByRef NumIntegrationPts As Integer()
    ) As Integer
    
    Dim instance As cPropArea
    Dim Name As String
    Dim NumberLayers As Integer
    Dim LayerName As String()
    Dim Dist As Double()
    Dim Thickness As Double()
    Dim MatProp As String()
    Dim Nonlinear As Boolean()
    Dim MatAng As Double()
    Dim NumIntegrationPts As Integer()
    Dim returnValue As Integer
    
    returnValue = instance.SetShellLayer(Name, 
    	NumberLayers, LayerName, Dist, Thickness, 
    	MatProp, Nonlinear, MatAng, NumIntegrationPts)
    
    
    int SetShellLayer(
    	String^ Name, 
    	int NumberLayers, 
    	array<String^>^% LayerName, 
    	array<double>^% Dist, 
    	array<double>^% Thickness, 
    	array<String^>^% MatProp, 
    	array<bool>^% Nonlinear, 
    	array<double>^% MatAng, 
    	array<int>^% NumIntegrationPts
    )
    
    
    abstract SetShellLayer : 
            Name : string * 
            NumberLayers : int * 
            LayerName : string[] byref * 
            Dist : float[] byref * 
            Thickness : float[] byref * 
            MatProp : string[] byref * 
            Nonlinear : bool[] byref * 
            MatAng : float[] byref * 
            NumIntegrationPts : int[] byref -> int 
    

#### Parameters

Name

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
The name of an existing shell-type area property that is specified to be a
layered shell property.

NumberLayers

    Type: [SystemInt32](https://docs.microsoft.com/dotnet/api/system.int32)  
The number of layers in the area property.

LayerName

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
This is an array that includes the name of each layer.

Dist

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
This is an array that includes the distance from the area reference surface
(area object joint location plus offsets) to the mid-height of the layer. [L]

Thickness

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
This is an array that includes the thickness of each layer. [L]

MatProp

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
This is an array that includes the name of the material property for the
layer.

Nonlinear

    Type: [SystemBoolean](https://docs.microsoft.com/dotnet/api/system.boolean)  

MatAng

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
This is an array that includes the material angle for the layer. [deg]

NumIntegrationPts

    Type: [SystemInt32](https://docs.microsoft.com/dotnet/api/system.int32)  
The number of integration points in the thickness direction for the layer. The
locations are determined by the program using standard Guass-quadrature rules.

#### Return Value

Type: [Int32](https://docs.microsoft.com/dotnet/api/system.int32)  
Returns zero if the parameters are successfully assigned; otherwise it returns
a nonzero value.

The function returns an error if the specified area property is not a shell-
type property specified to be a layered shell.

![](../icons/SectionExpanded.png)Remarks

![](../icons/SectionExpanded.png)Examples

VB

Copy

    
    
    Public Sub Example()
           Dim SapModel As cSapModel
           Dim EtabsObject As cOAPI
           Dim ret As Integer = -1
           Dim Name As String
           Dim MyNumberLayers As Integer
           Dim MyLayerName() As String
           Dim MyDist() As Double
           Dim MyThickness() As Double
           Dim MyNumIntegrationPts() As Integer
           Dim MyMatProp() As String
           Dim MyNonlinear() as Boolean
           Dim MyMatAng() As Double
    
       'create ETABS object
           Dim myHelper as cHelper = New Helper
           EtabsObject = myHelper.CreateObjectProgID("CSI.ETABS.API.ETABSObject")
    
       'start ETABS application
           ret = EtabsObject.ApplicationStart()
    
       'create SapModel object
           SapModel = EtabsObject.SapModel
    
       'initialize model
           ret = SapModel.InitializeNewModel()
    
       'create steel deck template model
           ret = SapModel.File.NewSteelDeck(4,12,12,4,4,24,24)
    
       'set new area property
           ret = SapModel.PropArea.SetWall("A1", eWallPropType.Specified, eShellType.Layered, "", 0)
    
       'add A615Gr60 rebar material
           ret = SapModel.PropMaterial.AddMaterial(Name, eMatType.Rebar, "United States", "ASTM A615", "Grade 60")
    
       'set area property layer parameters
           MyNumberLayers = 5
           ReDim MyLayerName(MyNumberLayers - 1)
           ReDim MyDist(MyNumberLayers - 1)
           ReDim MyThickness(MyNumberLayers - 1)
           ReDim MyNumIntegrationPts(MyNumberLayers - 1)
           ReDim MyMatProp(MyNumberLayers - 1)
           ReDim MyNonLinear(MyNumberLayers - 1)
           ReDim MyMatAng(MyNumberLayers - 1)
    
           MyLayerName(0) = "Concrete"
           MyDist(0) = 0
           MyThickness(0) = 16
           MyNumIntegrationPts(0) = 2
           MyMatProp(0) = "4000Psi"
           MyMatAng(0) = 0
    
           MyLayerName(1) = "Top Bar 1"
           MyDist(1) = 6
           MyThickness(1) = 0.03
           MyNumIntegrationPts(1) = 1
           MyMatProp(1) = Name
           MyMatAng(1) = 0
    
           MyLayerName(2) = "Top Bar 2"
           MyDist(2) = 6
           MyThickness(2) = 0.03
           MyNumIntegrationPts(2) = 1
           MyMatProp(2) = Name
           MyMatAng(2) = 90
    
           MyLayerName(3) = "Bot Bar 1"
           MyDist(3) = -6
           MyThickness(3) = 0.03
           MyNumIntegrationPts(3) = 1
           MyMatProp(3) = Name
           MyMatAng(3) = 0
    
           MyLayerName(4) = "Bot Bar 2"
           MyDist(4) = -6
           MyThickness(4) = 0.03
           MyNumIntegrationPts(4) = 1
           MyMatProp(4) = Name
           MyMatAng(4) = 90
    
           ret = SapModel.PropArea.SetShellLayer("A1", MyNumberLayers, MyLayerName, MyDist, MyThickness, MyMatProp, MyNonLinear, MyMatAng, MyNumIntegrationPts)
    
       'close ETABS
           EtabsObject.ApplicationExit(False)
    
       'clean up variables
           SapModel = Nothing
           EtabsObject = Nothing
       End Sub

![](../icons/SectionExpanded.png)See Also

#### Reference

[cPropArea Interface](05202e19-1948-3d93-0a27-426378bde769.htm)

[ETABSv1 Namespace](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)

ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers
and Structures, Inc.  

[Copyright © Computers and Structures, Inc. 2023. All rights
reserved.](http://www.csiamerica.com)

Send comments on this topic to
[support@csiamerica.com](mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1)

