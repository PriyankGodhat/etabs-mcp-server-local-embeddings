

CSI API ETABS v1

# cStoryGetStories Method  
  
---  
  
This function is DEPRECATED. Please refer to [GetStories_2(Double, Int32,
String, Double, Double, Boolean, String, Boolean, Double,
Int32)](cdbfa89c-ce72-fe61-a677-71d44012704f.htm)

Retrieves the story information for the current tower

**Namespace:** [ETABSv1](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)  
**Assembly:** ETABSv1 (in ETABSv1.dll) Version: 1.0.0.0 (1.27.0.0)

![](../icons/SectionExpanded.png)Syntax

C#

VB

C++

F#

Copy

    
    
    int GetStories(
    	ref int NumberStories,
    	ref string[] StoryNames,
    	ref double[] StoryElevations,
    	ref double[] StoryHeights,
    	ref bool[] IsMasterStory,
    	ref string[] SimilarToStory,
    	ref bool[] SpliceAbove,
    	ref double[] SpliceHeight
    )
    
    
    Function GetStories ( 
    	ByRef NumberStories As Integer,
    	ByRef StoryNames As String(),
    	ByRef StoryElevations As Double(),
    	ByRef StoryHeights As Double(),
    	ByRef IsMasterStory As Boolean(),
    	ByRef SimilarToStory As String(),
    	ByRef SpliceAbove As Boolean(),
    	ByRef SpliceHeight As Double()
    ) As Integer
    
    Dim instance As cStory
    Dim NumberStories As Integer
    Dim StoryNames As String()
    Dim StoryElevations As Double()
    Dim StoryHeights As Double()
    Dim IsMasterStory As Boolean()
    Dim SimilarToStory As String()
    Dim SpliceAbove As Boolean()
    Dim SpliceHeight As Double()
    Dim returnValue As Integer
    
    returnValue = instance.GetStories(NumberStories, 
    	StoryNames, StoryElevations, StoryHeights, 
    	IsMasterStory, SimilarToStory, SpliceAbove, 
    	SpliceHeight)
    
    
    int GetStories(
    	int% NumberStories, 
    	array<String^>^% StoryNames, 
    	array<double>^% StoryElevations, 
    	array<double>^% StoryHeights, 
    	array<bool>^% IsMasterStory, 
    	array<String^>^% SimilarToStory, 
    	array<bool>^% SpliceAbove, 
    	array<double>^% SpliceHeight
    )
    
    
    abstract GetStories : 
            NumberStories : int byref * 
            StoryNames : string[] byref * 
            StoryElevations : float[] byref * 
            StoryHeights : float[] byref * 
            IsMasterStory : bool[] byref * 
            SimilarToStory : string[] byref * 
            SpliceAbove : bool[] byref * 
            SpliceHeight : float[] byref -> int 
    

#### Parameters

NumberStories

    Type: [SystemInt32](https://docs.microsoft.com/dotnet/api/system.int32)  
The number of stories. All output arrays have length (NumberStories + 1),
because they include values for "Base" , which is not a story.

StoryNames

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
The names of the stories. This array will include "Base" .

StoryElevations

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
The story elevations. The first value is the "Base" elevation.

StoryHeights

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
The story heights. The first value is the "Base" height.

IsMasterStory

    Type: [SystemBoolean](https://docs.microsoft.com/dotnet/api/system.boolean)  
Whether the story is a master story

SimilarToStory

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
If the story is not a master story, which master story the story is similar to

SpliceAbove

    Type: [SystemBoolean](https://docs.microsoft.com/dotnet/api/system.boolean)  
This is True if the story has a splice height, and False otherwise

SpliceHeight

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
The story splice height

#### Return Value

Type: [Int32](https://docs.microsoft.com/dotnet/api/system.int32)  
Returns zero if the story data is successfully retrieved, otherwise returns
nonzero.

![](../icons/SectionExpanded.png)Remarks

To change the current tower, use
[SetActiveTower(String)](59404401-796c-f28d-0c18-314f935a59b0.htm)

![](../icons/SectionExpanded.png)Examples

VB

Copy

    
    
    Public Sub Example()
           Dim SapModel As cSapModel
           Dim EtabsObject As cOAPI
           Dim ret As Integer = -1
           Dim NumberStories As Integer
           Dim StoryNames() As String
           Dim StoryHeights() As Double
           Dim StoryElevations() As Double
           Dim IsMasterStory() As Boolean
           Dim SimilarToStory() As String
           Dim SpliceAbove() As Boolean
           Dim SpliceHeight() As Double
    
       'create ETABS object
           Dim myHelper as cHelper = New Helper
           EtabsObject = myHelper.CreateObjectProgID("CSI.ETABS.API.ETABSObject")
    
       'start ETABS application
           ret = EtabsObject.ApplicationStart()
    
       'create SapModel object
           SapModel = EtabsObject.SapModel
    
       'initialize model
           ret = SapModel.InitializeNewModel()
    
       'create steel deck template model
           ret = SapModel.File.NewSteelDeck(4,12,12,4,4,24,24)
    
       'get stories
       ret = SapModel.Story.GetStories(NumberStories, StoryNames, StoryHeights, StoryElevations, _
                                       IsMasterStory, SimilarToStory, SpliceAbove, SpliceHeight)
    
       'close ETABS
           EtabsObject.ApplicationExit(False)
    
       'clean up variables
           SapModel = Nothing
           EtabsObject = Nothing
       End Sub

![](../icons/SectionExpanded.png)See Also

#### Reference

[cStory Interface](1683ba07-55f5-11ab-520a-fc7bab96a41c.htm)

[ETABSv1 Namespace](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)

ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers
and Structures, Inc.  

[Copyright © Computers and Structures, Inc. 2023. All rights
reserved.](http://www.csiamerica.com)

Send comments on this topic to
[support@csiamerica.com](mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1)

