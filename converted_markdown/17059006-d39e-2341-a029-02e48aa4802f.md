

CSI API ETABS v1

# cStorySetStories Method  
  
---  
  
This function is DEPRECATED. Please refer to [SetStories_2(Double, Int32,
String, Double, Boolean, String, Boolean, Double,
Int32)](4d9a32f2-52d2-5fc1-3bf7-97a5b1c35198.htm)

Sets the stories for the current tower

**Namespace:** [ETABSv1](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)  
**Assembly:** ETABSv1 (in ETABSv1.dll) Version: 1.0.0.0 (1.27.0.0)

![](../icons/SectionExpanded.png)Syntax

C#

VB

C++

F#

Copy

    
    
    int SetStories(
    	string[] StoryNames,
    	double[] StoryElevations,
    	double[] StoryHeights,
    	bool[] IsMasterStory,
    	string[] SimilarToStory,
    	bool[] SpliceAbove,
    	double[] SpliceHeight
    )
    
    
    Function SetStories ( 
    	StoryNames As String(),
    	StoryElevations As Double(),
    	StoryHeights As Double(),
    	IsMasterStory As Boolean(),
    	SimilarToStory As String(),
    	SpliceAbove As Boolean(),
    	SpliceHeight As Double()
    ) As Integer
    
    Dim instance As cStory
    Dim StoryNames As String()
    Dim StoryElevations As Double()
    Dim StoryHeights As Double()
    Dim IsMasterStory As Boolean()
    Dim SimilarToStory As String()
    Dim SpliceAbove As Boolean()
    Dim SpliceHeight As Double()
    Dim returnValue As Integer
    
    returnValue = instance.SetStories(StoryNames, 
    	StoryElevations, StoryHeights, IsMasterStory, 
    	SimilarToStory, SpliceAbove, SpliceHeight)
    
    
    int SetStories(
    	array<String^>^ StoryNames, 
    	array<double>^ StoryElevations, 
    	array<double>^ StoryHeights, 
    	array<bool>^ IsMasterStory, 
    	array<String^>^ SimilarToStory, 
    	array<bool>^ SpliceAbove, 
    	array<double>^ SpliceHeight
    )
    
    
    abstract SetStories : 
            StoryNames : string[] * 
            StoryElevations : float[] * 
            StoryHeights : float[] * 
            IsMasterStory : bool[] * 
            SimilarToStory : string[] * 
            SpliceAbove : bool[] * 
            SpliceHeight : float[] -> int 
    

#### Parameters

StoryNames

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
The names of the stories

StoryElevations

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
The story elevations. This array has length (Number of stories + 1). The first
value in the array is the "Base" elevation, commonly 0.

StoryHeights

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
The story heights. Although this argument is not optional, an empty array may
be used, and the heights will be inferred from the StoryElevations array. This
array has length (Number of stories), with no value for "Base"

IsMasterStory

    Type: [SystemBoolean](https://docs.microsoft.com/dotnet/api/system.boolean)  
Whether the story is a master story. This array has length (Number of
stories), with no value for "Base"

SimilarToStory

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
If the story is not a master story, which master story the story is similar
to. This array has length (Number of stories), with no value for "Base"

SpliceAbove

    Type: [SystemBoolean](https://docs.microsoft.com/dotnet/api/system.boolean)  
This is True if the story has a splice height, and False otherwise. This array
has length (Number of stories), with no value for "Base"

SpliceHeight

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
The story splice heights, if applicable. This array has length (Number of
stories), with no value for "Base"

#### Return Value

Type: [Int32](https://docs.microsoft.com/dotnet/api/system.int32)  
Returns zero if the story data is successfully set, otherwise returns nonzero.

![](../icons/SectionExpanded.png)Remarks

To change the current tower, use
[SetActiveTower(String)](59404401-796c-f28d-0c18-314f935a59b0.htm)

![](../icons/SectionExpanded.png)Examples

VB

Copy

    
    
    Public Sub Example()
           Dim SapModel As cSapModel
           Dim EtabsObject As cOAPI
           Dim ret As Integer = -1
           Dim NumberStories As Integer
           Dim StoryNames() As String
           Dim StoryHeights() As Double
           Dim StoryElevations() As Double
           Dim IsMasterStory() As Boolean
           Dim SimilarToStory() As String
           Dim SpliceAbove() As Boolean
           Dim SpliceHeight() As Double
    
       'create ETABS object
           Dim myHelper as cHelper = New Helper
           EtabsObject = myHelper.CreateObjectProgID("CSI.ETABS.API.ETABSObject")
    
       'start ETABS application
           ret = EtabsObject.ApplicationStart()
    
       'create SapModel object
           SapModel = EtabsObject.SapModel
    
       'initialize model
           ret = SapModel.InitializeNewModel()
    
       'create steel deck template model
           ret = SapModel.File.NewSteelDeck(4,12,12,4,4,24,24)
    
       'set stories
           Dim inStoryNames As String() = {"MyStory1", "MyStory2", "MyStory3", "MyStory4", "MyStory5", "MyStory6"}
           Dim inStoryElevations As Double() = {0, 5, 15, 23, 23.5, 40, 50}
           Dim inStoryHeights As Double() = {2, 5, 7, 33, 1, 9}
           Dim inIsMasterStory As Boolean() = {False, False, False, False, False, True}
           Dim inSimilarToStory As String() = {"None", "", "MyStory6", "MyStory6", "MyStory6", "MyStory6"}
           Dim inSpliceAbove As Boolean() = {False, True, False, True, False, True}
           Dim inSpliceHeight As Double() = {0, 0, 2, 2, 0, 1}
    
           ret = SapModel.Story.SetStories(inStoryNames, inStoryElevations, inStoryHeights, _
                                       inIsMasterStory, inSimilarToStory, inSpliceAbove, inSpliceHeight)
    
       'get stories
           ret = SapModel.Story.GetStories(NumberStories, StoryNames, StoryHeights, StoryElevations, _
                                       IsMasterStory, SimilarToStory, SpliceAbove, SpliceHeight)
    
       'close ETABS
           EtabsObject.ApplicationExit(False)
    
       'clean up variables
           SapModel = Nothing
           EtabsObject = Nothing
       End Sub

![](../icons/SectionExpanded.png)See Also

#### Reference

[cStory Interface](1683ba07-55f5-11ab-520a-fc7bab96a41c.htm)

[ETABSv1 Namespace](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)

ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers
and Structures, Inc.  

[Copyright © Computers and Structures, Inc. 2023. All rights
reserved.](http://www.csiamerica.com)

Send comments on this topic to
[support@csiamerica.com](mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1)

