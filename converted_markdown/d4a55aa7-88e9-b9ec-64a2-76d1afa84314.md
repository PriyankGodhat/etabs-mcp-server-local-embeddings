

CSI API ETABS v1

# cAnalysisResultsModalLoadParticipationRatios Method  
  
---  
  
Reports the modal load participation ratios for each selected modal analysis
case

**Namespace:** [ETABSv1](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)  
**Assembly:** ETABSv1 (in ETABSv1.dll) Version: 1.0.0.0 (1.27.0.0)

![](../icons/SectionExpanded.png)Syntax

C#

VB

C++

F#

Copy

    
    
    int ModalLoadParticipationRatios(
    	ref int NumberResults,
    	ref string[] LoadCase,
    	ref string[] ItemType,
    	ref string[] Item,
    	ref double[] Stat,
    	ref double[] Dyn
    )
    
    
    Function ModalLoadParticipationRatios ( 
    	ByRef NumberResults As Integer,
    	ByRef LoadCase As String(),
    	ByRef ItemType As String(),
    	ByRef Item As String(),
    	ByRef Stat As Double(),
    	ByRef Dyn As Double()
    ) As Integer
    
    Dim instance As cAnalysisResults
    Dim NumberResults As Integer
    Dim LoadCase As String()
    Dim ItemType As String()
    Dim Item As String()
    Dim Stat As Double()
    Dim Dyn As Double()
    Dim returnValue As Integer
    
    returnValue = instance.ModalLoadParticipationRatios(NumberResults, 
    	LoadCase, ItemType, Item, Stat, Dyn)
    
    
    int ModalLoadParticipationRatios(
    	int% NumberResults, 
    	array<String^>^% LoadCase, 
    	array<String^>^% ItemType, 
    	array<String^>^% Item, 
    	array<double>^% Stat, 
    	array<double>^% Dyn
    )
    
    
    abstract ModalLoadParticipationRatios : 
            NumberResults : int byref * 
            LoadCase : string[] byref * 
            ItemType : string[] byref * 
            Item : string[] byref * 
            Stat : float[] byref * 
            Dyn : float[] byref -> int 
    

#### Parameters

NumberResults

    Type: [SystemInt32](https://docs.microsoft.com/dotnet/api/system.int32)  
The total number of results returned by the program

LoadCase

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
This is an array that includes the name of the modal load case associated with
each result

ItemType

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
This is an array that includes Load Pattern, Acceleration, Link or Panel Zone.
It specifies the type of item for which the modal load participation is
reported

Item

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
This is an array whose values depend on the ItemType. If the ItemType is Load
Pattern, this is the name of the load pattern.

If the ItemType is Acceleration, this is UX, UY, UZ, RX, RY, or RZ, indicating
the acceleration direction.

If the ItemType is Link, this is the name of the link followed by U1, U2, U3,
R1, R2, or R3 (in parenthesis), indicating the link degree of freedom for
which the output is reported.

If the ItemType is Panel Zone, this is the name of the joint to which the
panel zone is assigned, followed by U1, U2, U3, R1, R2, or R3 (in
parenthesis), indicating the degree of freedom for which the output is
reported.

Stat

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
This is an array that includes the percent static load participation ratio

Dyn

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
This is an array that includes the percent dynamic load participation ratio

#### Return Value

Type: [Int32](https://docs.microsoft.com/dotnet/api/system.int32)  
Returns zero if the data is successfully recovered; otherwise it returns a
nonzero value

![](../icons/SectionExpanded.png)Remarks

See [Results](0c2bc8bd-2382-75be-9075-b0a8245283c3.htm) for more information.

![](../icons/SectionExpanded.png)Examples

VB

Copy

    
    
    Public Sub Example()
    
       'dimension variables
       Dim SapObject as cOAPI
       Dim SapModel As cSapModel
       Dim ret As Integer = -1
       Dim NumberResults As Integer
       Dim LoadCase() As String
       Dim ItemType() As String
       Dim Item() As String
       Dim Stat() As Double
       Dim Dyn() As Double
    
       'create ETABS object
           Dim myHelper as cHelper = New Helper
           EtabsObject = myHelper.CreateObjectProgID("CSI.ETABS.API.ETABSObject")
    
       'start ETABS application
           ret = EtabsObject.ApplicationStart()
    
       'create SapModel object
           SapModel = EtabsObject.SapModel
    
       'initialize model
           ret = SapModel.InitializeNewModel()
    
       'create steel deck template model
           ret = SapModel.File.NewSteelDeck(4,12,12,4,4,24,24)
    
       'run analysis
           System.IO.Directory.CreateDirectory("c:\CSI_API_temp")
           ret = SapModel.File.Save("C:\CSI_API_temp\example.edb")
           ret = SapModel.Analyze.RunAnalysis()
    
       'deselect all cases and combos
           ret = SapModel.Results.Setup.DeselectAllCasesAndCombosForOutput()
    
       'set case selected for output
           ret = SapModel.Results.Setup.SetCaseSelectedForOutput("MODAL")
    
       'get modal load participation ratios
           ret = SapModel.Results.ModalLoadParticipationRatios(NumberResults, LoadCase, ItemType, Item, Stat, Dyn)
    
       'close ETABS
           EtabsObject.ApplicationExit(False)
    
       'clean up variables
           SapModel = Nothing
           EtabsObject = Nothing
       End Sub

![](../icons/SectionExpanded.png)See Also

#### Reference

[cAnalysisResults Interface](b64f2f6e-9759-e542-faf2-0905474a04a7.htm)

[ETABSv1 Namespace](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)

ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers
and Structures, Inc.  

[Copyright © Computers and Structures, Inc. 2023. All rights
reserved.](http://www.csiamerica.com)

Send comments on this topic to
[support@csiamerica.com](mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1)

