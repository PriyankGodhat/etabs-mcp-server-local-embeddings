

CSI API ETABS v1

# Information for Plugin Developers  
  
---  
  
This topic contains the following sections:

  * Plugin Considerations
  * The cPlugin Class
  * Adding Plugins

Plugins can be developed to make use of the ETABS API from inside the program.

No license is required to use the API for plugin development, beyond having a
valid license for ETABS. However, technical support for developing with the
API is not included. For qualified users and third-party developers who would
like technical support to help them build solutions and integrations with
ETABS using the ETABS API, Computers and Structures, Inc. has created a
subscription-based service, CSI Developer Network (CSIDN) (see
<http://www.csiamerica.com/support/csidn> ). Developers must subscribe to
CSIDN to be eligible for technical support for the ETABS API.

Plugins can be developed in a .NET compatible language (e.g. VB.NET, C#, etc.)
as a .NET DLL, or by using any language capable of creating a COM server
compiled as a DLL. An example plugin project can be found at:
<https://wiki.csiamerica.com/display/kb/Sample+Plugin+1>

![](../icons/SectionExpanded.png)Plugin Considerations

The plugin must reference the ETABSv1 API library (either ETABSv1.DLL or
ETABSv1.TLB ), which must be registered on the developer’s and the user’s
systems. This registration takes place during the installation of ETABS. The
ETABSv1.DLL is compiled as AnyCPU, hence it can be referenced by both 64-bit
and AnyCPU-compiled plugin projects.

Please note that COM plugins must be registered for COM on the user’s system,
before they can be used in ETABS. This will require that the ETABSv1.DLL be
present in the directory where the COM plugin is being registered. It is the
plugin developer's responsibility to instruct users how to install the plugin.
Plugins should be installed only after ETABS has been installed. COM Plugin
developers should consider that registering assemblies usually requires
administrative permissions, which many users may not have.

Plugins compiled as 32-bit will not work with 64-bit ETABS.

We recommend that developers create .NET plugins that are compiled as 64-bit
or AnyCPU . This will allow your plugin to be called from both 64-bit ETABS,
and will not require registration.

Please make sure your plugin is stable, handles errors well, and does not
cause any unintended changes to the user’s model.

We will attempt to maintain a stable interface in ETABS, however, that cannot
be guaranteed, and updates to your plugin may be required for future versions
of ETABS.

![](../icons/SectionExpanded.png)The cPlugin Class

In order for ETABS to be able to launch your plugin, your plugin assembly must
contain a class called cPlugin that implements the cPluginContract interface
in the ETABS API.

Please refer to the cPluginContract page for an explanation of its methods.
They are also described below.

Class cPlugin must contain two methods, cPlugin.Info and cPlugin.Main

VB

Copy

    
    
    Public Function Info(ByRef Text As String) As Integer

The function cPlugin.Info has one reference argument, Text, and returns a
32-bit signed integer. The return value should be zero if successful. The
string argument should be filled in by the function, and may be plain text or
rich text. This string will be displayed when the user first adds the plugin
to ETABS. You can use this string to tell the user the purpose and author of
the plugin. This is in addition to any information you may provide when the
user executes the plugin.

VB

Copy

    
    
    Public Sub Main(ByRef SapModel As ETABSv1.cSapModel, ByRef ISapPlugin As ETABSv1.cPluginCallback)

The subroutine cPlugin.Main is the entry point to launch your plugin. All
functionality in your plugin will proceed from this method. If your plugin has
an initial form, it should be opened within this method.

cPlugin.Main has two reference arguments of types ETABSv1.cSapModel and
ETABSv1.cPluginCallback:

The SapModel argument is a reference to the SapModel object upon which all
operations will be performed

For the ISapPlugin argument, please refer to the cPluginCallback page for an
explanation of its properties. Its only method is very important and explained
below.

VB

Copy

    
    
    ETABSv1.cPluginCallback.Finish(ByVal iVal As Integer)

ETABSv1.cPluginCallback contains a Finish subroutine that must be called
immediately before the plugin closes (e.g., if the plugin has a single main
window, at the end of the close event of that form). Its one argument, iVal,
is an error flag to let ETABS know if the operation was successful or not.
Zero indicates no error. ETABS will wait indefinitely for
ETABSv1.cPluginCallback.Finish to be called, so the plugin programmer must
make sure that it is called when the plugin completes.

It is OK for cPlugin.Main to return before the actual work is completed (e.g.,
return after displaying a form where the functionality implemented in the
plugin can be accessed through different command buttons). However, it is
imperative to call ETABSv1.cPluginCallback.Finish to return control back to
ETABS when the plugin is ready to close.

Your plugin should include options for the user to obtain information about
the product, developer, and technical support. Support for your plugin will
not be provided by Computers and Structures, Inc.

As currently implemented, the cPlugin object will be destroyed between
invocations from the ETABS Tools menu command that calls it, so data cannot be
saved.

![](../icons/SectionExpanded.png)Adding Plugins

####

![Blank Plugin Window](../media/BlankPluginWindow.PNG)

External Plugin Data Form

#### Adding a COM Plugin

To add a COM plugin to the Tools menu in ETABS, users will select "Add/Show
Plugins" from the Tools menu. In the External Plugin Data form, they will type
the name of the COM server DLL in the "Plugin Name" field.

Please note that ETABS will look for the plugin by Type Library name (usually
the name of the plugin project), which you define when developing your COM
server DLL. We suggest using a unique name such as ETABSPlugIn_xxx_yyy, where
xxx is your (company) name, and yyy is the name to distinguish the plugin from
other plugins that you develop, e.g. ETABSPlugIn_OmniCorp_Robo1.

The "Plugin Name" must exactly match the COM server DLL name. However, the
plugin will appear under the Tools menu under the "Menu Text" name. That can
be whatever the user likes, but it should be different for each plugin added.

The "Plugin Path" field should be left blank for COM plugins.

After clicking the "Add" button, the "Status" field will indicate whether the
plugin was successfully located in the registry and loaded.

#### Adding a .NET Plugin

The process for adding a .NET plugin is much simpler. In the External Plugin
Data form, the user should simply browse for and select the plugin .NET DLL
and click the "Add" button. The rest of the fields will be automatically
populated. It is still recommended that .NET plugins be given unique names.

ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers
and Structures, Inc.  

[Copyright © Computers and Structures, Inc. 2023. All rights
reserved.](http://www.csiamerica.com)

Send comments on this topic to
[support@csiamerica.com](mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1)

