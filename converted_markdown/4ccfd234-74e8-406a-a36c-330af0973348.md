

CSI API ETABS v1

# Programming Concepts Used in the CSi API  
  
---  
  
This topic contains the following sections:

  * Option Base
  * Fixed-Size and Dynamic Arrays
  * Optional Arguments
  * ByVal and ByRef

Some of the programming concepts and definitions that apply to the CSI API are
explained herein.

![](../icons/SectionExpanded.png)Option Base

ETABS uses a lower bound of 0 for all arrays. Any program that accesses ETABS
through the API should also use a lower bound of 0 for its arrays.

![](../icons/SectionExpanded.png)Fixed-Size and Dynamic Arrays

Arrays can be used to refer to a series of variables by the same name and to
use a number (an index) to distinguish them. Visual Basic has two types of
arrays: fixed-size and dynamic. A fixed-size array always remains the same
size. A dynamic array can change its size while the program is running.

A fixed-size array is declared with the size indicated. For example, the
following line declares MyFixedArray dimensioned to 2.

VB

Copy

    
    
    Dim MyFixedArray(2)as Double

Dimensioning the array to 2 means that it holds three data items:

VB

Copy

    
    
    MyFixedArray(0) = first data item
    MyFixedArray(1) = second data item
    MyFixedArray(2) = third data item

Dynamic arrays are declared with no size indicated as shown here:

VB

Copy

    
    
    Dim MyDynamicArray()as Double

Dynamic arrays are dimensioned sometime after they are declared using a
statement such as the following:

VB

Copy

    
    
    ReDim MyDynamicArray(2)

Any array that is dimensioned inside ETABS must be declared as a dynamic array
so that ETABS can redimension it. It is probably a good idea to declare all
arrays as dynamic arrays for simplicity. As an example, the analysis results
obtained through the CSI API are stored in arrays that are defined as dynamic
arrays by the user and then dimensioned and filled inside of ETABS.

![](../icons/SectionExpanded.png)Optional Arguments

Some of the CSI API functions have optional arguments. For example, the
CountLoadDispl function has two optional arguments: Name and LoadPat. It is
not necessary to include the optional arguments when calling this function.
All four of the following calls are valid.

VB

Copy

    
    
    ret = SapModel.PointObj.CountLoadDispl(Count)
    
    ret = SapModel.PointObj.CountLoadDispl(Count, Name)
    
    ret = SapModel.PointObj.CountLoadDispl(Count, , LoadPat)
    
    ret = SapModel.PointObj.CountLoadDispl(Count, Name, LoadPat)

Note in the third example, the first optional item is not included and the
second optional item is included. In that case, commas must be used to
delineate the missing arguments.

![](../icons/SectionExpanded.png)ByVal and ByRef

Variables are passed to the CSI API functions using the ByRef or the ByVal
keyword.

ByVal means that the variable is passed by value. This allows the CSI API to
access a copy of the variable but not the original variable. This means the
value of the variable in another application can not be changed by the API.

ByRef means the argument is passed by reference. This passes the address of
the variable to the CSI API instead of passing a copy of the value. It allows
the CSI API to access the actual variable, and, as a result, allows ETABS to
change the variable's actual value in an application.

Variables are passed ByRef when data needs to be returned in them from ETABS
to your application. In addition, the API requires that all arrays be passed
ByRef.

ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers
and Structures, Inc.  

[Copyright © Computers and Structures, Inc. 2023. All rights
reserved.](http://www.csiamerica.com)

Send comments on this topic to
[support@csiamerica.com](mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1)

