

CSI API ETABS v1

# cPropMaterialSetMassSource_1 Method  
  
---  
  
Sets the mass source for the model.

**Namespace:** [ETABSv1](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)  
**Assembly:** ETABSv1 (in ETABSv1.dll) Version: 1.0.0.0 (1.27.0.0)

![](../icons/SectionExpanded.png)Syntax

C#

VB

C++

F#

Copy

    
    
    int SetMassSource_1(
    	ref bool IncludeElements,
    	ref bool IncludeAddedMass,
    	ref bool IncludeLoads,
    	int NumberLoads,
    	ref string[] LoadPat,
    	ref double[] sf
    )
    
    
    Function SetMassSource_1 ( 
    	ByRef IncludeElements As Boolean,
    	ByRef IncludeAddedMass As Boolean,
    	ByRef IncludeLoads As Boolean,
    	NumberLoads As Integer,
    	ByRef LoadPat As String(),
    	ByRef sf As Double()
    ) As Integer
    
    Dim instance As cPropMaterial
    Dim IncludeElements As Boolean
    Dim IncludeAddedMass As Boolean
    Dim IncludeLoads As Boolean
    Dim NumberLoads As Integer
    Dim LoadPat As String()
    Dim sf As Double()
    Dim returnValue As Integer
    
    returnValue = instance.SetMassSource_1(IncludeElements, 
    	IncludeAddedMass, IncludeLoads, 
    	NumberLoads, LoadPat, sf)
    
    
    int SetMassSource_1(
    	bool% IncludeElements, 
    	bool% IncludeAddedMass, 
    	bool% IncludeLoads, 
    	int NumberLoads, 
    	array<String^>^% LoadPat, 
    	array<double>^% sf
    )
    
    
    abstract SetMassSource_1 : 
            IncludeElements : bool byref * 
            IncludeAddedMass : bool byref * 
            IncludeLoads : bool byref * 
            NumberLoads : int * 
            LoadPat : string[] byref * 
            sf : float[] byref -> int 
    

#### Parameters

IncludeElements

    Type: [SystemBoolean](https://docs.microsoft.com/dotnet/api/system.boolean)  
Include element self mass

IncludeAddedMass

    Type: [SystemBoolean](https://docs.microsoft.com/dotnet/api/system.boolean)  
Include additional masses

IncludeLoads

    Type: [SystemBoolean](https://docs.microsoft.com/dotnet/api/system.boolean)  
Include specified loads

NumberLoads

    Type: [SystemInt32](https://docs.microsoft.com/dotnet/api/system.int32)  
The number of load patterns from which mass is obtained. This item applies
only when IncludeLoads is True.

LoadPat

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
This is an array of the names of the load patterns from which mass is
obtained. This item applies only when IncludeLoads is True.

sf

    Type: [SystemDouble](https://docs.microsoft.com/dotnet/api/system.double)  
This is an array of load patterns multipliers used to calculate the mass. This
item applies only when IncludeLoads is True.

#### Return Value

Type: [Int32](https://docs.microsoft.com/dotnet/api/system.int32)  
Returns zero if the mass source is successfully set; otherwise it returns a
nonzero value.

![](../icons/SectionExpanded.png)Remarks

![](../icons/SectionExpanded.png)Examples

VB

Copy

    
    
    Public Sub Example()
           Dim SapModel As cSapModel
           Dim EtabsObject As cOAPI
           Dim ret As Integer = -1
           Dim MyLoadPat() As String
           Dim MySF() As Double
           Dim MyOption As Integer
           Dim NumberLoads As Integer
           Dim LoadPat() As String
           Dim sf() As Double    
    
       'create ETABS object
           Dim myHelper as cHelper = New Helper
           EtabsObject = myHelper.CreateObjectProgID("CSI.ETABS.API.ETABSObject")
    
       'start ETABS application
           ret = EtabsObject.ApplicationStart()
    
       'create SapModel object
           SapModel = EtabsObject.SapModel
    
       'initialize model
           ret = SapModel.InitializeNewModel()
    
       'create steel deck template model
           ret = SapModel.File.NewSteelDeck(4,12,12,4,4,24,24)
    
       'set mass source
           ReDim MyLoadPat(1)
           ReDim MySF(1)
           MyLoadPat(0) = "DEAD"
           MyLoadPat(1) = "LIVE"
           MySF(0) = 1
           MySF(1) = 0.2
           ret = SapModel.PropMaterial.SetMassSource(3, 2, MyLoadPat, MySF)
    
       'close ETABS
           EtabsObject.ApplicationExit(False)
    
       'clean up variables
           SapModel = Nothing
           EtabsObject = Nothing
       End Sub

![](../icons/SectionExpanded.png)See Also

#### Reference

[cPropMaterial Interface](9c207615-6f75-9e34-741c-041d0b2ac537.htm)

[ETABSv1 Namespace](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)

ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers
and Structures, Inc.  

[Copyright © Computers and Structures, Inc. 2023. All rights
reserved.](http://www.csiamerica.com)

Send comments on this topic to
[support@csiamerica.com](mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1)

