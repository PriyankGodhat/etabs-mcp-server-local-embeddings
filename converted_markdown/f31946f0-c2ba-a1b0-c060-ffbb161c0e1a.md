

CSI API ETABS v1

# cPropMaterialAddMaterial Method  
  
---  
  
Adds a new material property to the model.

**Namespace:** [ETABSv1](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)  
**Assembly:** ETABSv1 (in ETABSv1.dll) Version: 1.0.0.0 (1.27.0.0)

![](../icons/SectionExpanded.png)Syntax

C#

VB

C++

F#

Copy

    
    
    int AddMaterial(
    	ref string Name,
    	eMatType MatType,
    	string Region,
    	string Standard,
    	string Grade,
    	string UserName = ""
    )
    
    
    Function AddMaterial ( 
    	ByRef Name As String,
    	MatType As eMatType,
    	Region As String,
    	Standard As String,
    	Grade As String,
    	Optional UserName As String = ""
    ) As Integer
    
    Dim instance As cPropMaterial
    Dim Name As String
    Dim MatType As eMatType
    Dim Region As String
    Dim Standard As String
    Dim Grade As String
    Dim UserName As String
    Dim returnValue As Integer
    
    returnValue = instance.AddMaterial(Name, 
    	MatType, Region, Standard, Grade, 
    	UserName)
    
    
    int AddMaterial(
    	String^% Name, 
    	eMatType MatType, 
    	String^ Region, 
    	String^ Standard, 
    	String^ Grade, 
    	String^ UserName = L""
    )
    
    
    abstract AddMaterial : 
            Name : string byref * 
            MatType : eMatType * 
            Region : string * 
            Standard : string * 
            Grade : string * 
            ?UserName : string 
    (* Defaults:
            let _UserName = defaultArg UserName ""
    *)
    -> int 
    

#### Parameters

Name

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
This item is returned by the program. It is the name that the program
ultimately assigns for the material property. If no UserName is specified, the
program assigns a default name to the material property. If a UserName is
specified and that name is not used for another material property, the
UserName is assigned to the material property.

MatType

    Type: [ETABSv1eMatType](ffbe9449-058c-ac1b-3de7-072aad3bf460.htm)  
This is one of the items in the
[eMatType](ffbe9449-058c-ac1b-3de7-072aad3bf460.htm) enumeration.

Region

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
The region name of the material property that is user-predefined in the file
"CSiMaterialLibrary*.xml" located in subfolder "Property Libraries" under the
program installation.

Standard

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  
The Standard name of the material property with the specified MatType within
the specified region.

Grade

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  

UserName (Optional)

    Type: [SystemString](https://docs.microsoft.com/dotnet/api/system.string)  

#### Return Value

Type: [Int32](https://docs.microsoft.com/dotnet/api/system.int32)  
Returns zero if the material property is successfully added, otherwise it
returns a nonzero value.

![](../icons/SectionExpanded.png)Remarks

This function adds a new material property to the model based on the Code-
specified and other pre-defined material properties defined in the installed
file "CSiMaterialLibrary*.xml" located in subfolder "Property Libraries" under
the program installation folder.

![](../icons/SectionExpanded.png)Examples

VB

Copy

    
    
    Public Sub Example()
           Dim SapModel As cSapModel
           Dim EtabsObject As cOAPI
           Dim ret As Integer = -1
    
       'create ETABS object
           Dim myHelper as cHelper = New Helper
           EtabsObject = myHelper.CreateObjectProgID("CSI.ETABS.API.ETABSObject")
    
       'start ETABS application
           ret = EtabsObject.ApplicationStart()
    
       'create SapModel object
           SapModel = EtabsObject.SapModel
    
       'initialize model
           ret = SapModel.InitializeNewModel()
    
       'create steel deck template model
           ret = SapModel.File.NewSteelDeck(4,12,12,4,4,24,24)
    
       'add ASTM A706 rebar material property in United states Region
           ret = SapModel.PropMaterial.AddMaterial(Name, eMatType.Rebar, "United States", "ASTM A706", "Grade 60")
    
       'close ETABS
           EtabsObject.ApplicationExit(False)
    
       'clean up variables
           SapModel = Nothing
           EtabsObject = Nothing
       End Sub

![](../icons/SectionExpanded.png)See Also

#### Reference

[cPropMaterial Interface](9c207615-6f75-9e34-741c-041d0b2ac537.htm)

[ETABSv1 Namespace](2780f1b8-2033-5289-2298-1cdb2a7508d9.htm)

ETABS®, SAFE®, SAP2000® and CSiBridge® are registered trademarks of Computers
and Structures, Inc.  

[Copyright © Computers and Structures, Inc. 2023. All rights
reserved.](http://www.csiamerica.com)

Send comments on this topic to
[support@csiamerica.com](mailto:support%40csiamerica.com?Subject=CSI%20API%20ETABS%20v1)

